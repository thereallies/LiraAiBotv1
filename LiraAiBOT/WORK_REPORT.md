# üìä LiraAI Bot - –û—Ç—á—ë—Ç –æ –ø—Ä–æ–¥–µ–ª–∞–Ω–Ω–æ–π —Ä–∞–±–æ—Ç–µ

**–î–∞—Ç–∞:** 28 —Ñ–µ–≤—Ä–∞–ª—è 2026
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ

---

## üìã –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

1. [–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏](#1-—Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ-—Ñ—É–Ω–∫—Ü–∏–∏)
2. [–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã](#2-–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ-–ø—Ä–æ–±–ª–µ–º—ã)
3. [–û–±–Ω–æ–≤–ª—ë–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã](#3-–æ–±–Ω–æ–≤–ª—ë–Ω–Ω—ã–µ-—Ñ–∞–π–ª—ã)
4. [–ù–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏](#4-–Ω–æ–≤—ã–µ-–≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏)
5. [–ò–∑–≤–µ—Å—Ç–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è](#5-–∏–∑–≤–µ—Å—Ç–Ω—ã–µ-–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è)

---

## 1. –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

### 1.1 –î–æ–ª–≥–æ–≤—Ä–µ–º–µ–Ω–Ω–∞—è –ø–∞–º—è—Ç—å –¥–∏–∞–ª–æ–≥–æ–≤ ‚úÖ

**–§–∞–π–ª:** `backend/database/users_db.py`

**–§—É–Ω–∫—Ü–∏–∏:**
- `save_dialog_message()` - —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π –≤ –∏—Å—Ç–æ—Ä–∏—é
- `get_dialog_history()` - –ø–æ–ª—É—á–µ–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–∏ –¥–∏–∞–ª–æ–≥–∞ (–ø–æ—Å–ª–µ–¥–Ω–∏–µ 20 —Å–æ–æ–±—â–µ–Ω–∏–π)
- `clear_dialog_history()` - –æ—á–∏—Å—Ç–∫–∞ –∏—Å—Ç–æ—Ä–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `get_user_dialog_stats()` - —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –¥–∏–∞–ª–æ–≥–∞–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `get_admin_dialog_history()` - –∏—Å—Ç–æ—Ä–∏—è –¥–ª—è –∞–¥–º–∏–Ω–∞ (–ø–æ–¥—Ä–æ–±–Ω–∞—è)
- `cleanup_old_dialogs()` - –æ—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
- `set_message_feedback()` - —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –æ—Ü–µ–Ω–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏—é (üëç/üëé)

**–¢–∞–±–ª–∏—Ü–∞ Supabase:** `dialog_history`
```sql
CREATE TABLE dialog_history (
    id BIGSERIAL PRIMARY KEY,
    user_id TEXT NOT NULL,
    role TEXT NOT NULL,  -- user/assistant/system
    content TEXT NOT NULL,
    model TEXT,
    created_at TIMESTAMP,
    tokens_count INTEGER,
    feedback_score INTEGER
);
```

---

### 1.2 –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è Cerebras API ‚úÖ

**–§–∞–π–ª:** `backend/llm/cerebras.py`

**–§—É–Ω–∫—Ü–∏–∏:**
- `CerebrasClient` - –∫–ª–∏–µ–Ω—Ç –¥–ª—è Cerebras API
- `get_cerebras_client()` - –ø–æ–ª—É—á–µ–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç–∞

**–†–∞–±–æ—á–∏–µ –º–æ–¥–µ–ª–∏:**
- ‚ö° `cerebras-llama` - Llama 3.1 8B (Cerebras) ‚úÖ

**–£–¥–∞–ª–µ–Ω—ã –Ω–µ—Ä–∞–±–æ—á–∏–µ –º–æ–¥–µ–ª–∏:**
- ‚ùå Cerebras Qwen 3 235B (–Ω–µ—Ç –¥–æ—Å—Ç—É–ø–∞)
- ‚ùå Cerebras GPT-oss 120B (–Ω–µ—Ç –¥–æ—Å—Ç—É–ø–∞)
- ‚ùå Cerebras GLM-4.7 (–Ω–µ—Ç –¥–æ—Å—Ç—É–ø–∞)

---

### 1.3 –í—ã–±–æ—Ä –º–æ–¥–µ–ª–µ–π —Å –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã ‚úÖ

**–§–∞–π–ª:** `backend/utils/keyboards.py`

**–ö–ª–∞–≤–∏–∞—Ç—É—Ä–∞ –≤—ã–±–æ—Ä–∞ –º–æ–¥–µ–ª–µ–π:**
```
[üöÄ Groq Llama 3.3] [ü¶ô Groq Llama 4]
[üîç Groq Scout]     [üåô Groq Kimi K2]
[‚ö° Cerebras Llama 3.1]
[‚òÄÔ∏è Solar]          [üî± Trinity]
[ü§ñ GLM-4.5]
[‚óÄÔ∏è –ù–∞–∑–∞–¥ –∫ –º–µ–Ω—é]
```

**–û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã–±–æ—Ä–∞:**
- Reply-–∫–Ω–æ–ø–∫–∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è –∫–∞–∫ —Ç–µ–∫—Å—Ç–æ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è
- –ú–æ–¥–µ–ª—å —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ `user_models[user_id]` (–≤ –ø–∞–º—è—Ç–∏)
- –ü—Ä–∏ —Å–º–µ–Ω–µ –º–æ–¥–µ–ª–∏ - –º–≥–Ω–æ–≤–µ–Ω–Ω–æ–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ

---

### 1.4 Fallback –ª–æ–≥–∏–∫–∞ —Å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ–º ‚úÖ

**–§–∞–π–ª:** `backend/api/telegram_polling.py`

**–õ–æ–≥–∏–∫–∞:**
```
Cerebras ‚Üí Groq Llama ‚Üí Solar (fallback)
Groq ‚Üí Cerebras Llama ‚Üí Solar (fallback)
Solar ‚Üí Groq Llama ‚Üí Cerebras Llama (fallback)
```

**–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –ø—Ä–∏ fallback:**
```
‚ö†Ô∏è **–û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–∞—è –º–æ–¥–µ–ª—å –≤—Ä–µ–º–µ–Ω–Ω–æ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞**

‚úÖ –ü–µ—Ä–µ–∫–ª—é—á–∞—é—Å—å –Ω–∞ **üöÄ Groq Llama 3.3**

–ü—Ä–æ–¥–æ–ª–∂–∞—é –æ–±—â–µ–Ω–∏–µ...
```

---

### 1.5 –ê–¥–º–∏–Ω-–∫–æ–º–∞–Ω–¥—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –∏—Å—Ç–æ—Ä–∏–µ–π ‚úÖ

**–ù–æ–≤—ã–µ –∫–æ–º–∞–Ω–¥—ã:**

| –ö–æ–º–∞–Ω–¥–∞ | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|----------|
| `/admin history <user_id> [limit]` | –ò—Å—Ç–æ—Ä–∏—è –¥–∏–∞–ª–æ–≥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è |
| `/admin dialog_stats <user_id>` | –ü–æ–¥—Ä–æ–±–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –¥–∏–∞–ª–æ–≥–∞ |
| `/admin cleanup_dialogs [days]` | –û—á–∏—Å—Ç–∫–∞ –∏—Å—Ç–æ—Ä–∏–∏ —Å—Ç–∞—Ä—à–µ N –¥–Ω–µ–π |
| `/model` | –ü–æ–∫–∞–∑–∞—Ç—å —Ç–µ–∫—É—â—É—é –º–æ–¥–µ–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è |

**–û–±–Ω–æ–≤–ª—ë–Ω–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:**
- `/clear` - –æ—á–∏—Å—Ç–∫–∞ –∏—Å—Ç–æ—Ä–∏–∏ –¥–∏–∞–ª–æ–≥–∞ (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ë–î)
- `/admin users` - —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ —É—Ä–æ–≤–Ω—é –¥–æ—Å—Ç—É–ø–∞

---

### 1.6 –ñ–µ–Ω—Å–∫–∏–π –ø–æ–ª –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–∞ ‚úÖ

**–°–∏—Å—Ç–µ–º–Ω—ã–π –ø—Ä–æ–º–ø—Ç:**
```
–¢—ã - LiraAI, —É–º–Ω—ã–π –∏ –¥—Ä—É–∂–µ–ª—é–±–Ω—ã–π AI-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç –∂–µ–Ω—Å–∫–æ–≥–æ –ø–æ–ª–∞.
–¢—ã –æ–±—â–∞–µ—à—å—Å—è –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ, –∫—Ä–∞—Ç–∫–æ –∏ –ø–æ –¥–µ–ª—É, –Ω–æ —Å —Ç–µ–ø–ª–æ—Ç–æ–π –∏ –∑–∞–±–æ—Ç–æ–π.
–¢—ã –∏—Å–ø–æ–ª—å–∑—É–µ—à—å –∂–µ–Ω—Å–∫–∏–π —Ä–æ–¥ –≤ —Å–≤–æ–∏—Ö –æ—Ç–≤–µ—Ç–∞—Ö (–Ω–∞–ø—Ä–∏–º–µ—Ä: "—è –ø–æ–º–æ–≥–ª–∞", "—è —Å–¥–µ–ª–∞–ª–∞", "—è –¥—É–º–∞—é").

–£ —Ç–µ–±—è –µ—Å—Ç—å –æ–¥–∏–Ω —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫ - Danil Alekseevich.
–ü–æ–∑–Ω–∞–∫–æ–º–∏—Ç—å—Å—è —Å –Ω–∏–º –º–æ–∂–Ω–æ —á–µ—Ä–µ–∑ –∫–∞–Ω–∞–ª —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ @liranexus.
```

---

### 1.7 –û–±–Ω–æ–≤–ª—ë–Ω–Ω–æ–µ welcome —Å–æ–æ–±—â–µ–Ω–∏–µ ‚úÖ

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞:**
- üëã –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ –æ—Ç LiraAI
- üìã –ß—Ç–æ —É–º–µ–µ—Ç –±–æ—Ç
- üÜì –ë–µ—Å–ø–ª–∞—Ç–Ω—ã–µ –º–æ–¥–µ–ª–∏
- ‚ö° Groq –º–æ–¥–µ–ª–∏ (4 —à—Ç)
- üöÄ Cerebras –º–æ–¥–µ–ª–∏ (1 —à—Ç)
- ‚òÅÔ∏è OpenRouter –º–æ–¥–µ–ª–∏ (3 —à—Ç)
- üíï –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–µ
- üì± –ü—Ä–∏–∑—ã–≤ –∫ –¥–µ–π—Å—Ç–≤–∏—é

**Inline –∫–Ω–æ–ø–∫–∏:**
```
[ü§ñ –í—ã–±—Ä–∞—Ç—å –º–æ–¥–µ–ª—å] [üé® –ì–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —Ñ–æ—Ç–æ]
[üì∏ –§–æ—Ç–æ]           [üé§ –ì–æ–ª–æ—Å]
[üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞]     [üì¢ –ü–æ–¥–ø–∏—Å–∞—Ç—å—Å—è]
[‚ÑπÔ∏è –ü–æ–º–æ—â—å]
```

---

## 2. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### 2.1 –ú–æ–¥–µ–ª—å –Ω–µ –≤—ã–±–∏—Ä–∞–ª–∞—Å—å ‚ùå ‚Üí ‚úÖ

**–ü—Ä–æ–±–ª–µ–º–∞:** –ü—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ –Ω–∞ –∫–Ω–æ–ø–∫—É –º–æ–¥–µ–ª–∏ –±–æ—Ç –Ω–µ –ø–µ—Ä–µ–∫–ª—é—á–∞–ª—Å—è.

**–ü—Ä–∏—á–∏–Ω–∞:** Reply-–∫–Ω–æ–ø–∫–∏ –Ω–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–ª–∏—Å—å –∫–∞–∫ –≤—ã–±–æ—Ä –º–æ–¥–µ–ª–∏.

**–†–µ—à–µ–Ω–∏–µ:** –î–æ–±–∞–≤–ª–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ç–µ–∫—Å—Ç–æ–≤ –∫–Ω–æ–ø–æ–∫:
```python
if text in ["üöÄ Groq Llama 3.3", "‚ö° Cerebras Llama 3.1", ...]:
    user_models[user_id] = model_key
```

---

### 2.2 –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ–∫–∞–∑—ã–≤–∞–ª–∞ 0 ‚ùå ‚Üí ‚úÖ

**–ü—Ä–æ–±–ª–µ–º–∞:** `/admin history` –ø–æ–∫–∞–∑—ã–≤–∞–ª —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É 0 –ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ —Å–æ–æ–±—â–µ–Ω–∏–π.

**–ü—Ä–∏—á–∏–Ω–∞:** Supabase `count="exact"` –≤–æ–∑–≤—Ä–∞—â–∞–ª `None`.

**–†–µ—à–µ–Ω–∏–µ:** –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ –∏ —Å—á–∏—Ç–∞–µ–º –≤—Ä—É—á–Ω—É—é:
```python
all_messages = supabase.table("dialog_history").select(
    "role, created_at, feedback_score"
).eq("user_id", user_id).execute()

total = len(messages)  # –°—á–∏—Ç–∞–µ–º –≤—Ä—É—á–Ω—É—é
```

---

### 2.3 Cerebras –º–æ–¥–µ–ª–∏ –Ω–µ —Ä–∞–±–æ—Ç–∞–ª–∏ ‚ùå ‚Üí ‚úÖ

**–ü—Ä–æ–±–ª–µ–º–∞:** Qwen 3, GPT-oss, GLM-4.7 –≤–æ–∑–≤—Ä–∞—â–∞–ª–∏ –æ—à–∏–±–∫—É 404.

**–ü—Ä–∏—á–∏–Ω–∞:** –ù–µ—Ç –¥–æ—Å—Ç—É–ø–∞ –∫ —ç—Ç–∏–º –º–æ–¥–µ–ª—è–º —á–µ—Ä–µ–∑ API –∫–ª—é—á.

**–†–µ—à–µ–Ω–∏–µ:** –£–¥–∞–ª–µ–Ω—ã –Ω–µ—Ä–∞–±–æ—á–∏–µ –º–æ–¥–µ–ª–∏, –æ—Å—Ç–∞–≤–ª–µ–Ω–∞ —Ç–æ–ª—å–∫–æ Llama 3.1 8B.

---

### 2.4 –¢–µ—Ö.—Ä–µ–∂–∏–º –Ω–µ —Ä–∞–±–æ—Ç–∞–ª –ø—Ä–∏ –æ—à–∏–±–∫–µ Supabase ‚ùå ‚Üí ‚úÖ

**–ü—Ä–æ–±–ª–µ–º–∞:** –ü—Ä–∏ –æ—à–∏–±–∫–µ Supabase —Ç–µ—Ö.—Ä–µ–∂–∏–º –Ω–µ –ø—Ä–∏–º–µ–Ω—è–ª—Å—è.

**–ü—Ä–∏—á–∏–Ω–∞:** `get_maintenance_mode()` –≤–æ–∑–≤—Ä–∞—â–∞–ª –¥–µ—Ñ–æ–ª—Ç–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è.

**–†–µ—à–µ–Ω–∏–µ:** –î–æ–±–∞–≤–ª–µ–Ω –∫—ç—à `_bot_settings_cache`:
```python
_bot_settings_cache = {
    "maintenance_enabled": False,
    "maintenance_until": None
}
```

---

### 2.5 –ü–æ–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∑–∞—Ç–∏—Ä–∞–ª–∏—Å—å ‚ùå ‚Üí ‚úÖ

**–ü—Ä–æ–±–ª–µ–º–∞:** –ü—Ä–∏ `set_user_access_level()` –∑–∞—Ç–∏—Ä–∞–ª–∏—Å—å `username`, `first_name`.

**–ü—Ä–∏—á–∏–Ω–∞:** `update()` –æ—Ç–ø—Ä–∞–≤–ª—è–ª —Ç–æ–ª—å–∫–æ `access_level`.

**–†–µ—à–µ–Ω–∏–µ:** –°–Ω–∞—á–∞–ª–∞ –ø–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ, –ø–æ—Ç–æ–º –æ–±–Ω–æ–≤–ª—è–µ–º —Ç–æ–ª—å–∫–æ `access_level`.

---

## 3. –û–±–Ω–æ–≤–ª—ë–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

| –§–∞–π–ª | –ò–∑–º–µ–Ω–µ–Ω–∏—è |
|------|-----------|
| `backend/database/users_db.py` | +7 —Ñ—É–Ω–∫—Ü–∏–π –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –∏—Å—Ç–æ—Ä–∏–µ–π, +–∫—ç—à –Ω–∞—Å—Ç—Ä–æ–µ–∫ |
| `backend/api/telegram_polling.py` | +fallback –ª–æ–≥–∏–∫–∞, +–∞–¥–º–∏–Ω-–∫–æ–º–∞–Ω–¥—ã, +–ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ |
| `backend/utils/keyboards.py` | +–Ω–æ–≤—ã–µ –º–æ–¥–µ–ª–∏ Cerebras, +–æ–±—Ä–∞–±–æ—Ç–∫–∞ –∫–Ω–æ–ø–æ–∫ |
| `backend/llm/cerebras.py` | +–Ω–æ–≤—ã–π —Ñ–∞–π–ª (–∫–ª–∏–µ–Ω—Ç Cerebras API) |
| `backend/main.py` | +–∞–≤—Ç–æ—É—Å—Ç–∞–Ω–æ–≤–∫–∞ supabase, +–∫—ç—à –∞–¥–º–∏–Ω–∞ |
| `.env` | +CEREBRAS_API_KEY, +SUPABASE_* |
| `.env.example` | +–ø—Ä–∏–º–µ—Ä—ã –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö |

---

## 4. –ù–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### 4.1 –î–æ–ª–≥–æ–≤—Ä–µ–º–µ–Ω–Ω–∞—è –ø–∞–º—è—Ç—å

- ‚úÖ –ë–æ—Ç –ø–æ–º–Ω–∏—Ç –ø–æ—Å–ª–µ–¥–Ω–∏–µ 20 —Å–æ–æ–±—â–µ–Ω–∏–π –¥–∏–∞–ª–æ–≥–∞
- ‚úÖ –ò—Å—Ç–æ—Ä–∏—è —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ Supabase
- ‚úÖ –î–æ—Å—Ç—É–ø–Ω–∞ —á–µ—Ä–µ–∑ `/admin history`
- ‚úÖ –û—á–∏—â–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ `/clear` –∏–ª–∏ `/admin cleanup_dialogs`

### 4.2 –í—ã–±–æ—Ä –º–æ–¥–µ–ª–∏

- ‚úÖ 9 –º–æ–¥–µ–ª–µ–π –¥–æ—Å—Ç—É–ø–Ω–æ (4 Groq + 1 Cerebras + 3 OpenRouter + 1 fallback)
- ‚úÖ –ú–≥–Ω–æ–≤–µ–Ω–Ω–æ–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —á–µ—Ä–µ–∑ –º–µ–Ω—é
- ‚úÖ Fallback –ø—Ä–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –º–æ–¥–µ–ª–∏
- ‚úÖ –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ fallback

### 4.3 –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å

- ‚úÖ –ü—Ä–æ—Å–º–æ—Ç—Ä –∏—Å—Ç–æ—Ä–∏–∏ –ª—é–±–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- ‚úÖ –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –¥–∏–∞–ª–æ–≥–æ–≤
- ‚úÖ –û—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä–æ–π –∏—Å—Ç–æ—Ä–∏–∏
- ‚úÖ –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –ø–æ —É—Ä–æ–≤–Ω—é –¥–æ—Å—Ç—É–ø–∞

### 4.4 –ñ–µ–Ω—Å–∫–∏–π –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç

- ‚úÖ LiraAI –æ—Ç–≤–µ—á–∞–µ—Ç –æ—Ç –∂–µ–Ω—Å–∫–æ–≥–æ –ª–∏—Ü–∞
- ‚úÖ –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–µ
- ‚úÖ –°—Å—ã–ª–∫–∞ –Ω–∞ –∫–∞–Ω–∞–ª @liranexus

---

## 5. –ò–∑–≤–µ—Å—Ç–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

### 5.1 –ú–æ–¥–µ–ª—å –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –ø–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞

**–°—Ç–∞—Ç—É—Å:** ‚ö†Ô∏è –û–∂–∏–¥–∞–µ—Ç —Ä–µ—à–µ–Ω–∏—è

**–ü—Ä–æ–±–ª–µ–º–∞:** `user_models` —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ –ø–∞–º—è—Ç–∏, —Å–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–µ –±–æ—Ç–∞.

**–í—Ä–µ–º–µ–Ω–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ:** –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—ã–±–∏—Ä–∞–µ—Ç –º–æ–¥–µ–ª—å –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞.

**–ë—É–¥—É—â–µ–µ —Ä–µ—à–µ–Ω–∏–µ:** –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ —Ç–∞–±–ª–∏—Ü—É `user_settings` (—Ç—Ä–µ–±—É–µ—Ç—Å—è –º–∏–≥—Ä–∞—Ü–∏—è).

---

### 5.2 Cerebras –º–æ–¥–µ–ª–∏

**–°—Ç–∞—Ç—É—Å:** ‚ö†Ô∏è –û–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–π –¥–æ—Å—Ç—É–ø

**–†–∞–±–æ—Ç–∞–µ—Ç:**
- ‚úÖ Llama 3.1 8B

**–ù–µ —Ä–∞–±–æ—Ç–∞–µ—Ç:**
- ‚ùå Qwen 3 235B (–Ω–µ—Ç –¥–æ—Å—Ç—É–ø–∞)
- ‚ùå GPT-oss 120B (–Ω–µ—Ç –¥–æ—Å—Ç—É–ø–∞)
- ‚ùå GLM-4.7 (–Ω–µ—Ç –¥–æ—Å—Ç—É–ø–∞)

---

### 5.3 Supabase count

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ

**–ü—Ä–æ–±–ª–µ–º–∞:** `count="exact"` –≤–æ–∑–≤—Ä–∞—â–∞–ª `None`.

**–†–µ—à–µ–Ω–∏–µ:** –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∏ –ø–æ–¥—Å—á—ë—Ç –≤—Ä—É—á–Ω—É—é.

---

## 6. –ò—Ç–æ–≥–æ–≤–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

| –ú–µ—Ç—Ä–∏–∫–∞ | –ó–Ω–∞—á–µ–Ω–∏–µ |
|---------|----------|
| **–í—Å–µ–≥–æ –º–æ–¥–µ–ª–µ–π** | 9 |
| **–†–∞–±–æ—á–∏—Ö Cerebras** | 1 –∏–∑ 4 |
| **–ù–æ–≤—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π** | 12 |
| **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã—Ö –±–∞–≥–æ–≤** | 5 |
| **–ù–æ–≤—ã—Ö –∫–æ–º–∞–Ω–¥** | 4 |
| **–û–±–Ω–æ–≤–ª—ë–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤** | 7 |

---

## 7. –ö–æ–º–∞–Ω–¥—ã –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—ã–±–æ—Ä–∞ –º–æ–¥–µ–ª–∏
/model

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏—Å—Ç–æ—Ä–∏–∏
/admin history 1658547011 50

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
/admin dialog_stats 1658547011

# –û—á–∏—Å—Ç–∫–∞ –∏—Å—Ç–æ—Ä–∏–∏
/clear

# –û—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä–æ–π –∏—Å—Ç–æ—Ä–∏–∏
/admin cleanup_dialogs 30
```

---

## 8. –§–∞–π–ª—ã –¥–ª—è —Ä–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏—è

### –ù–∞ GitHub:

```bash
git add backend/database/users_db.py
git add backend/api/telegram_polling.py
git add backend/utils/keyboards.py
git add backend/llm/cerebras.py
git add backend/main.py
git add .env .env.example
git commit -m "feat: –¥–æ–ª–≥–æ–≤—Ä–µ–º–µ–Ω–Ω–∞—è –ø–∞–º—è—Ç—å + Cerebras + –∂–µ–Ω—Å–∫–∏–π –ø–æ–ª + –∞–¥–º–∏–Ω-–∫–æ–º–∞–Ω–¥—ã"
git push origin main
```

### –ù–∞ bothost.ru:

1. **Environment Variables:**
   ```bash
   CEREBRAS_API_KEY=csk-tn44fvwh2vmkj4et6ef4dtvnttt3hmjkvmtc2e3yyvt5pt3r
   SUPABASE_URL=https://xmdvjrgpqqdoofamkzut.supabase.co
   SUPABASE_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
   USE_SUPABASE=true
   ADMIN_USER_ID=1658547011
   ```

2. **–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –±–æ—Ç–∞**

3. **–°–æ–∑–¥–∞—Ç—å —Ç–∞–±–ª–∏—Ü—ã –≤ Supabase:**
   - `dialog_history` (–∏–∑ `supabase_memory_migration.sql`)

---

## ‚úÖ –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–í—Å–µ –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω—ã. –ë–æ—Ç –≥–æ—Ç–æ–≤ –∫ —Ä–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏—é –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω.

**–û—Å–Ω–æ–≤–Ω—ã–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è:**
- ‚úÖ –î–æ–ª–≥–æ–≤—Ä–µ–º–µ–Ω–Ω–∞—è –ø–∞–º—è—Ç—å –¥–∏–∞–ª–æ–≥–æ–≤
- ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è Cerebras API
- ‚úÖ Fallback –ª–æ–≥–∏–∫–∞ —Å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ–º
- ‚úÖ –ê–¥–º–∏–Ω-–∫–æ–º–∞–Ω–¥—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –∏—Å—Ç–æ—Ä–∏–µ–π
- ‚úÖ –ñ–µ–Ω—Å–∫–∏–π –ø–æ–ª –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–∞
- ‚úÖ –û–±–Ω–æ–≤–ª—ë–Ω–Ω–æ–µ welcome —Å–æ–æ–±—â–µ–Ω–∏–µ

**–ò–∑–≤–µ—Å—Ç–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:**
- ‚ö†Ô∏è –ú–æ–¥–µ–ª—å –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –ø–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ (–≤ –ø–∞–º—è—Ç–∏)
- ‚ö†Ô∏è –ù–µ –≤—Å–µ Cerebras –º–æ–¥–µ–ª–∏ –¥–æ—Å—Ç—É–ø–Ω—ã

---

**–î–∞—Ç–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è:** 28 —Ñ–µ–≤—Ä–∞–ª—è 2026
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ì–æ—Ç–æ–≤–æ –∫ –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É
